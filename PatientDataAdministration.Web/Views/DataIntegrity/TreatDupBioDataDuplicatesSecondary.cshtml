
@{
    ViewBag.Title = "TreatDupBioDataDuplicatesSecondary";
    Layout = "~/Views/Shared/_LayoutSecure.cshtml";
}

@section styles{
    <style>
        .dataTables_filter {
            text-align: left !important;
            float: right !important;
        }
    </style>
}

<div class="col-md-3 col-sm-12">
    <div class="panel panel-inverse">
        <div class="panel-heading">
            <h4 class="panel-title">Biometric Duplicate Cases</h4>
        </div>
        <div class="alert alert-success fade in">
            Please select a Case to Work On.
        </div>
        <div class="panel-body">
            <table id="data-table" class="table table-striped table-bordered table-responsive m-5">
                <thead>
                    <tr>
                        <th>Case Files</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>OG-09-0054 <button ng-click="loadData('OG-09-0054')" class="pull-right btn btn-xs btn-success">View Cases</button></td>
                    </tr>
                    <tr>
                        <td>OG-08-0010 <button ng-click="loadData('OG-08-0010')" class="pull-right btn btn-xs btn-success">View Cases</button></td>
                    </tr>
                    <tr>
                        <td>BU-12-0315 <button ng-click="loadData('BU-12-0315')" class="pull-right btn btn-xs btn-success">View Cases</button></td>
                    </tr>
                    <tr>
                        <td>bu-12-0034 <button ng-click="loadData('bu-12-0034')" class="pull-right btn btn-xs btn-success">View Cases</button></td>
                    </tr>
                    <tr>
                        <td>NM-09-0799 <button ng-click="loadData('NM-09-0799')" class="pull-right btn btn-xs btn-success">View Cases</button></td>
                    </tr>
                    <tr>
                        <td>OG-08-0157 <button ng-click="loadData('OG-08-0157')" class="pull-right btn btn-xs btn-success">View Cases</button></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<div class="col-md-9 col-sm-12">
    <div class="panel panel-inverse">
        <div class="panel-heading">
            <h4 class="panel-title">
                Records Found
                <span class="text text-success" ng-if="caseId != null"><strong>Suspected Duplications in Case {{caseId}}</strong></span>
                <span id="spanLoading" class="text-center text-warning">
                    &nbsp;Loading ... Please Wait&nbsp;
                </span>
            </h4>
        </div>
        <div class="panel-body">
            <div class="height-500" data-scrollbar="true">
                <div ng-if="patientSuspectData == null">
                    <div class="note note-info">
                        <h4>Please select a Case on the left</h4>
                    </div>
                </div>
                <ul class="media-list media-list-with-divider media-messaging" ng-repeat="patientSuspect in patientSuspectData track by $index">
                    <li class="media media-xs m-b-20">
                        <div class="media-body">
                            Suspect {{$index + 1}}:
                            <h4 class="media-heading">
                                <strong>{{patientSuspect.PatientInformation.PepId}} </strong>[{{patientSuspect.PatientInformation.PepId}}]
                            </h4>
                            <div class="col-md-6 col-sm-6 col-xs-12">
                                <div class="widget widget-stats bg-red-darker">
                                    <div class="stats-icon stats-icon-lg"><i class="fa fa-clone fa-fw"></i></div>
                                    <div class="stats-title">Match with {{patientSuspect.SuspectData.PivotPepId}}</div>
                                    <div class="stats-number">{{patientSuspect.SuspectData.PointAgg}} Points Aggregate over {{patientSuspect.SuspectData.MatchScore}}%</div>
                                    <div class="stats-progress progress">
                                        <div class="progress-bar" style="width: {{patientSuspect.SuspectData.MatchScore}}%;"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12 p-b-5 m-t-5">
                                <span class="panel panel-success">
                                    <button class="btn btn-info btn-xs" type="button" ng-click="createNew(patient)"><i class="fa fa-plus"></i>&nbsp;Remove Pivot Data</button>
                                    <button class="btn btn-success btn-xs" type="button" ng-click="selectPreffered(patient)"><i class="fa fa-shield"></i>&nbsp;Remove Suspect Data</button>
                                    <button class="btn btn-danger btn-xs" type="button" ng-click="delete(patient)"><i class="fa fa-trash"></i>&nbsp;Resolve as Unique</button>
                                </span>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

@section scripts
{
    <script src="/assets/js/table_manage_keytable_demo.js"></script>
    <script>
        $(document).ready(function() {
            TableManageKeyTable.init();
            $('#spanLoading').hide();
        });

        pdaWeb.controller('pdaWebCtrlr',
            function($scope) {
                $scope.patientData = null;
                $scope.patientSuspectData = null;
                $scope.pepId = null;
                $scope.caseId = null;
                $scope.biometricCaseRecords = {};

                $scope.loadData = function (pepId) {
                    $scope.patientSuspectData = getData(pepId);
                }
            });

        function getData(pivotPepId) {
            if (pivotPepId === 'OG-09-0054')
                return [
                    {
                        "SuspectData": {
                            "PivotPepId": "BU-12-0010",
                            "PointAgg": 3,
                            "MatchScore": 92
                        },
                        "PatientInformation": {
                            "PepId": "OG-09-0054"
                        }
                    }
                ];
            
            if (pivotPepId === 'OG-08-0157')
                return [
                    {
                        "SuspectData": {
                            "PivotPepId": "BU-12-1569",
                            "PointAgg": 10,
                            "MatchScore": 95
                        },
                        "PatientInformation": {
                            "PepId": "OG-08-0157"
                        }
                    }
                ];
            
            if (pivotPepId === 'NM-09-0799')
                return [
                    {
                        "SuspectData": {
                            "PivotPepId": "BU-12-0121",
                            "PointAgg": 6,
                            "MatchScore": 96
                        },
                        "PatientInformation": {
                            "PepId": "NM-09-0799"
                        }
                    }
                ];
            
            if (pivotPepId === 'bu-12-0034')
                return [
                    {
                        "SuspectData": {
                            "PivotPepId": "NM-08-0903",
                            "PointAgg": 7,
                            "MatchScore": 97
                        },
                        "PatientInformation": {
                            "PepId": "bu-12-0034"
                        }
                    }
                ];
            
            if (pivotPepId === 'BU-12-0315')
                return [
                    {
                        "SuspectData": {
                            "PivotPepId": "OG-08-0089",
                            "PointAgg": 10,
                            "MatchScore": 91
                        },
                        "PatientInformation": {
                            "PepId": "BU-12-0315"
                        }
                    }
                ];
            
            if (pivotPepId === 'OG-08-0010')
                return [
                    {
                        "SuspectData": {
                            "PivotPepId": "BU-12-0137",
                            "PointAgg": 9,
                            "MatchScore": 98
                        },
                        "PatientInformation": {
                            "PepId": "OG-08-0010"
                        }
                    }
                ];
        }
    </script>
}